"use strict";(self.webpackChunkdocsite_poc_github_io=self.webpackChunkdocsite_poc_github_io||[]).push([[13889],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(n),m=r,k=u["".concat(s,".").concat(m)]||u[m]||d[m]||i;return n?a.createElement(k,o(o({ref:t},p),{},{components:n})):a.createElement(k,o({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var c=2;c<i;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},87173:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var a=n(87462),r=(n(67294),n(3905));const i={title:"Objective-C (iOS) (0.9.0)",date:"2020-03-05",sidebar_position:920},o=void 0,l={unversionedId:"collecting-data/collecting-from-own-applications/mobile-trackers/previous-versions/objective-c-tracker/objective-c-0-9-0/index",id:"collecting-data/collecting-from-own-applications/mobile-trackers/previous-versions/objective-c-tracker/objective-c-0-9-0/index",title:"Objective-C (iOS) (0.9.0)",description:"Setup",source:"@site/docs/collecting-data/collecting-from-own-applications/mobile-trackers/previous-versions/objective-c-tracker/objective-c-0-9-0/index.md",sourceDirName:"collecting-data/collecting-from-own-applications/mobile-trackers/previous-versions/objective-c-tracker/objective-c-0-9-0",slug:"/collecting-data/collecting-from-own-applications/mobile-trackers/previous-versions/objective-c-tracker/objective-c-0-9-0/",permalink:"/docs/collecting-data/collecting-from-own-applications/mobile-trackers/previous-versions/objective-c-tracker/objective-c-0-9-0/",draft:!1,editUrl:"https://github.com/snowplow/snowplow.github.io/tree/main/docs/collecting-data/collecting-from-own-applications/mobile-trackers/previous-versions/objective-c-tracker/objective-c-0-9-0/index.md",tags:[],version:"current",lastUpdatedAt:1661526030,formattedLastUpdatedAt:"Aug 26, 2022",sidebarPosition:920,frontMatter:{title:"Objective-C (iOS) (0.9.0)",date:"2020-03-05",sidebar_position:920},sidebar:"tutorialSidebar",previous:{title:"Objective-C (iOS) (1.0.0)",permalink:"/docs/collecting-data/collecting-from-own-applications/mobile-trackers/previous-versions/objective-c-tracker/objective-c-1-0-0/"},next:{title:"Objective-C (iOS) (0.8.0)",permalink:"/docs/collecting-data/collecting-from-own-applications/mobile-trackers/previous-versions/objective-c-tracker/objective-c-0-8-0/"}},s={},c=[{value:"Setup",id:"setup",level:2},{value:"Dependencies",id:"dependencies",level:3},{value:"CocoaPods",id:"cocoapods",level:2},{value:"Carthage",id:"carthage",level:2},{value:"Manual Setup",id:"manual-setup",level:2},{value:"Clone the tracker",id:"clone-the-tracker",level:4},{value:"Copy the tracker into your project",id:"copy-the-tracker-into-your-project",level:4},{value:"Add the FMDB dependency",id:"add-the-fmdb-dependency",level:4},{value:"Import all required frameworks",id:"import-all-required-frameworks",level:4},{value:"Building",id:"building",level:4},{value:"Static Library Setup",id:"static-library-setup",level:3},{value:"Add the OpenIDFA dependency",id:"add-the-openidfa-dependency",level:4},{value:"Quick start",id:"quick-start",level:2},{value:"Demo apps",id:"demo-apps",level:2},{value:"Tracker Structure",id:"tracker-structure",level:2},{value:"SPEmitter",id:"spemitter",level:3},{value:"SPTracker",id:"sptracker",level:3},{value:"SPPayload",id:"sppayload",level:3},{value:"SPSelfDescribingJson",id:"spselfdescribingjson",level:3},{value:"SPSubject",id:"spsubject",level:3},{value:"SPEvent",id:"spevent",level:3},{value:"SPRequestCallback",id:"sprequestcallback",level:3},{value:"Tracker Structure",id:"tracker-structure-1",level:2},{value:"Creating an emitter",id:"creating-an-emitter",level:3},{value:"Creating a tracker",id:"creating-a-tracker",level:3},{value:"Sending events",id:"sending-events",level:3},{value:"Screenview event",id:"screenview-event",level:4},{value:"Attaching contexts to events",id:"attaching-contexts-to-events",level:3},{value:"More advanaced methods",id:"more-advanaced-methods",level:2},{value:"Tracking features",id:"tracking-features",level:3},{value:"Session tracking",id:"session-tracking",level:4},{value:"Foreground and background events",id:"foreground-and-background-events",level:5},{value:"Screen view tracking",id:"screen-view-tracking",level:5},{value:"Exception tracking",id:"exception-tracking",level:5},{value:"Install tracking",id:"install-tracking",level:5},{value:"Standard contexts",id:"standard-contexts",level:4},{value:"Session context",id:"session-context",level:5},{value:"Application context",id:"application-context",level:5},{value:"Screen Context",id:"screen-context",level:5},{value:"Platform context",id:"platform-context",level:5},{value:"Geolocation context",id:"geolocation-context",level:5},{value:"Emitter options",id:"emitter-options",level:3},{value:"Setting the request method",id:"setting-the-request-method",level:4},{value:"Setting the protocol",id:"setting-the-protocol",level:4},{value:"Setting a callback",id:"setting-a-callback",level:4},{value:"Range",id:"range",level:4},{value:"Thread pool size",id:"thread-pool-size",level:4},{value:"GET byte limit",id:"get-byte-limit",level:4},{value:"POST byte limit",id:"post-byte-limit",level:4},{value:"Global contexts",id:"global-contexts",level:3},{value:"Context primitives",id:"context-primitives",level:4},{value:"Self-describing JSON",id:"self-describing-json",level:5},{value:"IDFA tracking",id:"idfa-tracking",level:3},{value:"API Reference",id:"api-reference",level:2}],p={toc:c};function d(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"setup"},"Setup"),(0,r.kt)("h3",{id:"dependencies"},"Dependencies"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The Tracker has a dependency to the ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/ccgus/fmdb"},"FMDB"),"\xa0library for database management.")),(0,r.kt)("h2",{id:"cocoapods"},"CocoaPods"),(0,r.kt)("p",null,"If you're installing via CocoaPods, the dependencies are recursively downloaded for your project so you don't have to worry about it."),(0,r.kt)("p",null,"First make sure that Cocoapods is installed on your system."),(0,r.kt)("p",null,"For instructions, refer to the official Cocoapods guide\xa0",(0,r.kt)("a",{parentName:"p",href:"https://guides.cocoapods.org/using/getting-started.html"},"here"),"."),(0,r.kt)("p",null,"The tracker can be used in your project by adding\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"SnowplowTracker"),"\xa0to your project\u2019s\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"Podfile"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"pod 'SnowplowTracker', '~> 1.2'\n")),(0,r.kt)("p",null,"Now you can install the dependency in your project with the command:\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"pod\xa0install"),"."),(0,r.kt)("p",null,"Make sure to always open the Xcode workspace instead of the project file when building your project:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"$ open App.xcworkspace\n")),(0,r.kt)("p",null,"Now you can import classes in order to use the tracker e.g.:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},'#import "SPPayload.h"\n#import "SPTracker.h"\n#import "SPSelfDescribingJson.h"\n#import "SPEvent.h"\n')),(0,r.kt)("h2",{id:"carthage"},"Carthage"),(0,r.kt)("p",null,"In order to add the tracker to a project that uses Carthage, add the line to your\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"Cartfile"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},'github "snowplow/snowplow-objc-tracker" ~> 1.2\n')),(0,r.kt)("p",null,"Run\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"carthage\xa0update"),"\xa0and drag the appropriate frameworks to your project from the\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"Carthage/build"),"\xa0folder found in the project\u2019s folder."),(0,r.kt)("p",null,"The tracker can be imported like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"import <SnowplowTracker/SPTracker.h>\n")),(0,r.kt)("h2",{id:"manual-setup"},"Manual Setup"),(0,r.kt)("p",null,"If you prefer not to use CocoaPods, you can grab the tracker from our ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/snowplow/snowplow-objc-tracker"},"GitHub repo"),"\xa0and import it into your project."),(0,r.kt)("h4",{id:"clone-the-tracker"},(0,r.kt)("a",{parentName:"h4",href:"https://github.com/snowplow/snowplow/wiki/iOS-Tracker-Setup#clone-the-tracker"}),"Clone the tracker"),(0,r.kt)("p",null,"First, git clone the latest version of the tracker to your local machine:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"git clone https://github.com/snowplow/snowplow-objc-tracker.git\n")),(0,r.kt)("h4",{id:"copy-the-tracker-into-your-project"},(0,r.kt)("a",{parentName:"h4",href:"https://github.com/snowplow/snowplow/wiki/iOS-Tracker-Setup#copy-the-tracker-into-your-project"}),"Copy the tracker into your project"),(0,r.kt)("p",null,"You only need to copy the tracker's\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"Snowplow"),"\xa0sub-folder into your XCode project's folder. The command will look something like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"cp -r snowplow-objc-tracker/Snowplow MyObjcApp/MyObjcApp/\n")),(0,r.kt)("p",null,"Replace\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"MyObjcApp"),"\xa0with the name of your own app, and tweak the source code sub-folder accordingly."),(0,r.kt)("p",null,"Next, drag and drop the sub-folder\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"MyObjcApp/MyObjcApp/Snowplow"),"\xa0into your XCode project's workspace. Make sure that the suggested options for adding\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"Snowplow"),"\xa0are set\xa0",(0,r.kt)("strong",{parentName:"p"},"Create groups"),", then click\xa0",(0,r.kt)("strong",{parentName:"p"},"Finish"),"."),(0,r.kt)("h4",{id:"add-the-fmdb-dependency"},"Add the FMDB dependency"),(0,r.kt)("p",null,"The tracker is dependent on\xa0",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ccgus/fmdb"},"FMDB"),", an Objective-C wrapper around SQLite."),(0,r.kt)("p",null,"As before, git clone the dependency and copy the source into your XCode project's folder:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"git clone https://github.com/ccgus/fmdb.git\ncd fmdb && git checkout 2.6.2\ncp -r src/fmdb ../MyObjcApp/MyObjcApp/\n")),(0,r.kt)("p",null,"As before, drag and drop the sub-folder\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"MyObjcApp/MyObjcApp/fmdb"),"\xa0into your XCode project's workspace, making sure to\xa0",(0,r.kt)("strong",{parentName:"p"},"Create groups"),"."),(0,r.kt)("p",null,"Finally, you will need to edit\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"Snowplow/SPEmitter.m"),"\xa0and\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"Snowplow/SPEventStore.m"),"\xa0in X-Code and change:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"#import <FMDB.h>\n")),(0,r.kt)("p",null,"to:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},'#import "FMDB.h"\n')),(0,r.kt)("h4",{id:"import-all-required-frameworks"},"Import all required frameworks"),(0,r.kt)("p",null,"The tracker also depends on various frameworks:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"$ grep 'frameworks' ../snowplow-objc-tracker/SnowplowTracker.podspec\n  s.ios.frameworks = 'CoreTelephony', 'UIKit', 'Foundation'\n  s.osx.frameworks = 'AppKit', 'Foundation'\n")),(0,r.kt)("p",null,"Go to\xa0",(0,r.kt)("strong",{parentName:"p"},"Target"),"\xa0>\xa0",(0,r.kt)("strong",{parentName:"p"},"General"),"\xa0tab >\xa0",(0,r.kt)("strong",{parentName:"p"},"Linked Frameworks and Libraries"),"\xa0section and add:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"All of the frameworks for your target platform, as returned by the ",(0,r.kt)("inlineCode",{parentName:"li"},"grep"),"\xa0above"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"libsqlite3.dylib"))),(0,r.kt)("h4",{id:"building"},(0,r.kt)("a",{parentName:"h4",href:"https://github.com/snowplow/snowplow/wiki/iOS-Tracker-Setup#building"}),"Building"),(0,r.kt)("p",null,"Now\xa0",(0,r.kt)("strong",{parentName:"p"},"Build"),"\xa0your project and you should see\xa0",(0,r.kt)("strong",{parentName:"p"},"Build Succeeded"),". If you get a build error, check that you added Snowplow and fmdb as Groups, not just as Folders."),(0,r.kt)("p",null,"You are now ready to proceed to instrumenting your app. Just remember to use quotation marks not angle brackets, and the\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"Snowplow"),"\xa0sub-folder as necessary when importing the tracker:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},'#import "SPTracker.h"\n#import "SPEmitter.h"\n')),(0,r.kt)("h3",{id:"static-library-setup"},"Static Library Setup"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Currently the Static Library is only available for iOS, not for OS-X.")),(0,r.kt)("p",null,"We also now support including the SnowplowTracker as a static library import."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Download the static library's zipfile from\xa0",(0,r.kt)("a",{parentName:"li",href:"https://bintray.com/artifact/download/snowplow/snowplow-generic/snowplow_objc_tracker_0.7.0.zip"},"bintray")),(0,r.kt)("li",{parentName:"ul"},"Unzip the static library's zipfile to a location (doesn't need to be inside your app)"),(0,r.kt)("li",{parentName:"ul"},"Go to\xa0",(0,r.kt)("inlineCode",{parentName:"li"},"Projects->TARGETS->Build Phases->Link Binary With Libraries")),(0,r.kt)("li",{parentName:"ul"},"Press the plus in the lower left of the list"),(0,r.kt)("li",{parentName:"ul"},"Navigate to where you downloaded the Tracker to and then add the framework")),(0,r.kt)("p",null,"To activate the library:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Go to\xa0",(0,r.kt)("inlineCode",{parentName:"li"},"Projects->TARGETS->Build Settings")),(0,r.kt)("li",{parentName:"ul"},"Make sure you are browsing\xa0",(0,r.kt)("inlineCode",{parentName:"li"},"All"),"\xa0settings, not just\xa0",(0,r.kt)("inlineCode",{parentName:"li"},"Basic")),(0,r.kt)("li",{parentName:"ul"},"Search for\xa0",(0,r.kt)("inlineCode",{parentName:"li"},"Other Linker Flags")),(0,r.kt)("li",{parentName:"ul"},"Ensure that the\xa0",(0,r.kt)("inlineCode",{parentName:"li"},"-ObjC"),"\xa0flag has been added")),(0,r.kt)("p",null,"To import the library headers into your project you will need to add them with the name of the library prepended like so:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},'#import "SnowplowTracker/SPTracker.h"\n')),(0,r.kt)("p",null,"This portion was based on the developers guide from Apple on\xa0",(0,r.kt)("a",{parentName:"p",href:"https://developer.apple.com/library/ios/technotes/iOSStaticLibraries/Articles/configuration.html"},"importing static libraries"),"."),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Please note"),"\xa0that you will need to add in all Tracker dependencies manually as they are not included in the static download."),(0,r.kt)("h4",{id:"add-the-openidfa-dependency"},"Add the OpenIDFA dependency"),(0,r.kt)("p",null,"If you are embedding this app in an iOS app, then you will need to add ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ylechelle/OpenIDFA"},"OpenIDFA"),", which has been intentionally excluded from the Static Library."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Do not add OpenIDFA for a macOS app.")),(0,r.kt)("p",null,"As before, git clone the dependency and copy the source into your XCode project's folder:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"git clone https://github.com/ylechelle/OpenIDFA.git\ngit checkout 382db601ca12a7710b8fe583e710f9cfcbf42c4f\ncd OpenIDFA\ncp OpenIDFA.{h,m} ../MyObjcApp/MyObjcApp/\n")),(0,r.kt)("p",null,"Now add the\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"OpenIDFA.{h,m}"),"\xa0files to your project by:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Right-clicking on your\xa0",(0,r.kt)("inlineCode",{parentName:"li"},"MyObjcApp"),"\xa0folder in XCode"),(0,r.kt)("li",{parentName:"ul"},'Selecting Add Files to "MyObjcApp"...'),(0,r.kt)("li",{parentName:"ul"},"Selecting both OpenIDFA files and adding them")),(0,r.kt)("p",null,"Dependencies are needed in order to use the Obj-C tracker library in your application. These can be installed manually, or through package managers."),(0,r.kt)("h2",{id:"quick-start"},"Quick start"),(0,r.kt)("p",null,"The Tracker is designed to be used as a Singleton object, meaning that you should have only one instance of Tracker within your application. Without setting this up:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Multiple Emitters could become active resulting in the same events being sent multiple times."),(0,r.kt)("li",{parentName:"ul"},"Thrashing of the database."),(0,r.kt)("li",{parentName:"ul"},"Hogging of resources for sending HTTP requests which can slow your application.")),(0,r.kt)("p",null,"For a basic example of the Singleton pattern:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},'// --- Header File \'SnowplowManager.h\'\n\n@class SPTracker;\n\n@interface SnowplowManager : NSObject {\n    SPTracker *tracker;\n}\n\n@property (nonatomic, retain) SPTracker *tracker;\n\n+ (id) snowplowManager;\n\n@end\n\n// --- Method File \'SnowplowManager.m\'\n\n#import "SnowplowManager.h"\n#import "SPTracker.h"\n#import "SPEmitter.h"\n\n@implementation SnowplowManager\n\n@synthesize tracker;\n\n#pragma mark Singleton Methods\n\n+ (id) snowplowManager {\n    static SnowplowManager *sharedSnowplowManager = nil;\n    static dispatch_once_t onceToken;\n    dispatch_once(&onceToken, ^{\n        sharedSnowplowManager = [[self alloc] init];\n    });\n    return sharedSnowplowManager;\n}\n\n- (id) init {\n  self = [super init];\n  if (self) {\n    SPEmitter *emitter = [SPEmitter build:^(id<SPEmitterBuilder> builder) {\n        [builder setUrlEndpoint:@"com.acme"];\n    }];\n    tracker = [SPTracker build:^(id<SPTrackerBuilder> builder) {\n        [builder setEmitter:emitter];\n    }];\n  }\n  return self;\n}\n\n@end\n\ufeff\n')),(0,r.kt)("p",null,"You can then access your Tracker via ",(0,r.kt)("inlineCode",{parentName:"p"},"SnowplowManager\xa0*snowplowManager\xa0=\xa0[SnowplowManager\xa0snowplowManager]"),"."),(0,r.kt)("h2",{id:"demo-apps"},"Demo apps"),(0,r.kt)("p",null,"With the tracker we\u2019ve included few demo apps that can be used to demonstrate working iOS apps that integrate the tracker and allow you to send events to a collector."),(0,r.kt)("p",null,"They can be found in the\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"Examples"),"\xa0folder:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"SnowplowDemo"),": an Objective-C app;"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"SnowplowSwiftCarthageDemo"),": a Swift app which imports dependencies using Carthage."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"SnowplowSwiftCocoapodsDemo"),": a Swift app which imports dependencies using Cocoapods.")),(0,r.kt)("p",null,"The two Swift apps share the same codebase. The unique difference is in the configuration for the dependency managers."),(0,r.kt)("p",null,"For general testing,\xa0",(0,r.kt)("a",{parentName:"p",href:"/docs/understanding-your-pipeline/what-is-snowplow-mini/"},"Snowplow Mini"),"\xa0can be used as an easily deployable collector with a live web interface for viewing received events."),(0,r.kt)("p",null,"The apps can be run in an emulator or on an actual Apple device through Xcode."),(0,r.kt)("p",null,"Simply enter the endpoint of the collector in the app\u2019s interface once it\u2019s launched and press\xa0",(0,r.kt)("inlineCode",{parentName:"p"},'"send\xa0events"'),"!"),(0,r.kt)("h2",{id:"tracker-structure"},"Tracker Structure"),(0,r.kt)("p",null,"Here we\u2019ll explain the purpose of the classes provided in the tracker."),(0,r.kt)("h3",{id:"spemitter"},"SPEmitter"),(0,r.kt)("p",null,"Responsible for all the storage, networking and scheduling required to ensure events are sent to a collector."),(0,r.kt)("p",null,"Details like the collector endpoint and sending timeout lengths are set here."),(0,r.kt)("h3",{id:"sptracker"},"SPTracker"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"SPTracker"),"\xa0is the class where you can find the methods available for tracking events. This is also where all parts of the tracker are brought together, i.e. within\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"SPTracker"),"\xa0you must set the associated emitter, subject, etc."),(0,r.kt)("h3",{id:"sppayload"},"SPPayload"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"SPPayload"),"\xa0is simply a key-value store used for constructing events."),(0,r.kt)("h3",{id:"spselfdescribingjson"},"SPSelfDescribingJson"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"SPSelfDescribingJson"),"\xa0is a class used for constructing self-describing JSONs (SDJs)."),(0,r.kt)("p",null,"An SDJ has two fields:\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"schema"),"\xa0and\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"data"),". The\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"schema"),"\xa0field is a URI that specifies where to find the schema that defines the structure of the data nested in the\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"data"),"\xa0field."),(0,r.kt)("p",null,"A self-describing JSON is sent directly to the collector. All events are self-describing JSONs."),(0,r.kt)("p",null,"Generally speaking, when sending your own custom events, you will want to create a\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"SPSelfDescribingJson"),"\xa0object instantiated with two arguments: the schema, and a\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"SPPayload"),"\xa0or\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"NSDictionary"),"\xa0that holds the structured data you\u2019d like to track."),(0,r.kt)("h3",{id:"spsubject"},"SPSubject"),(0,r.kt)("p",null,"A \u201csubject\u201d represents an individual user that is being tracked. It is used to track data that persists with a user like timezone, user ID, platform, etc."),(0,r.kt)("h3",{id:"spevent"},"SPEvent"),(0,r.kt)("p",null,"This is where all events are found, the available classes are:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"SPPageView"),(0,r.kt)("li",{parentName:"ul"},"SPStructured"),(0,r.kt)("li",{parentName:"ul"},"SPUnstructured"),(0,r.kt)("li",{parentName:"ul"},"SPScreenView"),(0,r.kt)("li",{parentName:"ul"},"SPConsentWithdrawn"),(0,r.kt)("li",{parentName:"ul"},"SPConsentGranted"),(0,r.kt)("li",{parentName:"ul"},"SPConsentDocument"),(0,r.kt)("li",{parentName:"ul"},"SPTiming"),(0,r.kt)("li",{parentName:"ul"},"SPEcommTransaction"),(0,r.kt)("li",{parentName:"ul"},"SPEcommTransactionItem"),(0,r.kt)("li",{parentName:"ul"},"SPNotificationContent"),(0,r.kt)("li",{parentName:"ul"},"SPPushNotification")),(0,r.kt)("p",null,"Events are sent by providing them as arguments to the tracking methods found in\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"SPTracker"),"."),(0,r.kt)("h3",{id:"sprequestcallback"},"SPRequestCallback"),(0,r.kt)("p",null,"This is a class that defines callbacks that are called when an emitter either fails or succeeds to send requests."),(0,r.kt)("h2",{id:"tracker-structure-1"},"Tracker Structure"),(0,r.kt)("h3",{id:"creating-an-emitter"},"Creating an emitter"),(0,r.kt)("p",null,"Every tracker must have an emitter, so an emitter must be created first."),(0,r.kt)("p",null,"The URL endpoint must be defined."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPEmitter *emitter = [SPEmitter build:^(id<SPEmitterBuilder> builder) {\n    [builder setUrlEndpoint:_url];\n    [builder setProtocol:SPHttp];\n}];\n")),(0,r.kt)("h3",{id:"creating-a-tracker"},"Creating a tracker"),(0,r.kt)("p",null,"To instantiate a tracker in your code simply instantiate the\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"SPTracker"),"\xa0class with the following builder pattern:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPTracker *tracker = [SPTracker build:^(id<SPTrackerBuilder> builder) {\n    [builder setEmitter:emitter];\n}];\n")),(0,r.kt)("p",null,"By default iOS app sets automatically the parameter\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"p"),"\xa0(platform) as\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"mob"),"\xa0and desktop app sets it to\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"pc"),". However, there are cases where you want to specify that differently by the default option."),(0,r.kt)("p",null,"On the tracker setup you can override the device platform entry calling:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"[tracker setDevicePlatform: SPDevicePlatformGameConsole];\n")),(0,r.kt)("p",null,"It resets the parameter\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"p"),"\xa0(platform) to the new value."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/docs/collecting-data/collecting-from-own-applications/snowplow-tracker-protocol/"},"Here"),"\xa0a full list of the supported platform values."),(0,r.kt)("h3",{id:"sending-events"},"Sending events"),(0,r.kt)("p",null,"The following methods are available for sending events from the tracker:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"trackPageViewEvent"),(0,r.kt)("li",{parentName:"ul"},"trackStructuredEvent"),(0,r.kt)("li",{parentName:"ul"},"trackUnstructuredEvent"),(0,r.kt)("li",{parentName:"ul"},"trackSelfDescribingEvent (self-describing event is an alias for unstructured event)"),(0,r.kt)("li",{parentName:"ul"},"trackScreenViewEvent"),(0,r.kt)("li",{parentName:"ul"},"trackTimingEvent"),(0,r.kt)("li",{parentName:"ul"},"trackEcommerceEvent"),(0,r.kt)("li",{parentName:"ul"},"trackConsentWithdrawnEvent"),(0,r.kt)("li",{parentName:"ul"},"trackConsentGrantedEvent"),(0,r.kt)("li",{parentName:"ul"},"trackPushNotificationEvent")),(0,r.kt)("p",null,"In order to send an event, an event must first be made, and then supplied to a tracking method."),(0,r.kt)("p",null,"Here\u2019s an example of constructing and sending a custom event:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},'NSDictionary * data = @{@"level": @23, @"score": @56473};\nSPSelfDescribingJson * sdj = [[SPSelfDescribingJson alloc] initWithSchema:@"iglu:com.acme/save_game/jsonschema/1-0-0"\n                                                                  andData:data];\n\nSPUnstructured *event = [SPUnstructured build:^(id<SPUnstructuredBuilder> builder) {\n  [builder setEventData:sdj];\n}];\n\n[tracker trackUnstructuredEvent:event];\n')),(0,r.kt)("h4",{id:"screenview-event"},"Screenview event"),(0,r.kt)("p",null,"A screenview event can be manually tracked like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},'SPScreenView *event = [SPScreenView build:^(id<SPScreenViewBuilder> builder) {\n  [builder setName:@"Home screen"];\n  [builder setType:@"Navigation bar"];\n  [builder setScreenId:@"some Id"]\n  [builder setPreviousScreenName:@"Info screen"];\n  [builder setPreviousScreenType:@"Navigation bar"];\n  [builder setPreviousScreenId:@"another Id"]\n  [builder setTransitionType:@"swipe"]\n}];\n\n[tracker trackScreenViewEvent:event];\n')),(0,r.kt)("h3",{id:"attaching-contexts-to-events"},"Attaching contexts to events"),(0,r.kt)("p",null,"Contexts augment events with additional information. The tracker has standard contexts for automatically attaching useful information like geolocation, session, or app version/build to every event."),(0,r.kt)("p",null,"Each event has an argument for custom contexts in order to attach information that isn\u2019t covered by standard contexts."),(0,r.kt)("p",null,"The custom context argument should consist of a NSMutableArray of NSDictionary representing an array of one or more contexts. The format of each individual context element is the same as for an unstructured event (referring to the fact that it consists of a schema and data field - they\u2019re all self-describing JSONs)."),(0,r.kt)("p",null,"If a visitor arrives on a page advertising a movie, the context dictionary might look like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "schema": "iglu:com.acme_company/movie_poster/jsonschema/2-1-1",\n  "data": {\n    "movieName": "The Guns of Navarone",\n    "posterCountry": "US",\n    "posterYear": "1961"\n  }\n}\n')),(0,r.kt)("p",null,"The corresponding NSDictionary would look like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},'NSDictionary *poster = @{\n                         @"schema":@"iglu:com.acme_company/movie_poster/jsonschema/1-0-0",\n                         @"data": @{\n                                 @"movieName": @"The Guns of Navarone",\n                                 @"posterCountry": @"US",\n                                 @"posterYear": @"1961"\n                                 }\n                         };\n')),(0,r.kt)("p",null,"Sending the movie poster context with an event looks like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},'event = [SPStructured build:^(id<SPStructuredBuilder> builder) {\n  [builder setCategory:@"DemoCategory"];\n  [builder setAction:@"DemoAction"];\n  [builder setContexts:[NSMutableArray arrayWithArray:@[poster]]];\n}];\n[tracker trackStructuredEvent:event];\n')),(0,r.kt)("p",null,"Note: even if there is only one custom context attached to the event, it still needs to be placed in an array."),(0,r.kt)("h2",{id:"more-advanaced-methods"},"More advanaced methods"),(0,r.kt)("h3",{id:"tracking-features"},"Tracking features"),(0,r.kt)("h4",{id:"session-tracking"},"Session tracking"),(0,r.kt)("p",null,"By default, no client session tracking is activated. Once enabled the tracker will start appending a\xa0",(0,r.kt)("a",{parentName:"p",href:"https://github.com/snowplow/iglu-central/blob/master/schemas/com.snowplowanalytics.snowplow/client_session/jsonschema/1-0-1"},"client","_","session"),"\xa0context to each event it sends and it will maintain this session information for the life of the application, i.e. as long as the application is installed on the device."),(0,r.kt)("p",null,"Sessions correspond to tracked user activity. A session expires when no tracking events have occurred for the amount of time defined in a timeout. When a session expires, the session ID is incremented and session checking will stop. There are two timeouts since a session can timeout in the foreground (while the app is visible) or in the background (when the app has been suspended, but not closed)."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPTracker *tracker = [SPTracker build:^(id<SPTrackerBuilder> builder) {\n    ...\n    [builder setForegroundTimeout:600]; // 10 minutes\n    [builder setBackgroundTimeout:300]; // 5 minutes\n}];\n")),(0,r.kt)("h5",{id:"foreground-and-background-events"},"Foreground and background events"),(0,r.kt)("p",null,"In order to enable these events, use the method\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"setLifecycleEvents"),"\xa0during initialization of the tracker:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPTracker *tracker = [SPTracker build:^(id<SPTrackerBuilder> builder) {\n    [builder setEmitter:emitter];\n    [builder setLifecycleEvents:YES];\n}];\n")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/snowplow/iglu-central/blob/master/schemas/com.snowplowanalytics.snowplow/application_foreground/jsonschema/1-0-0"},"Foreground events"),"\xa0are sent whenever an app is opened or resumed."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/snowplow/iglu-central/blob/master/schemas/com.snowplowanalytics.snowplow/application_background/jsonschema/1-0-0"},"Background events"),"\xa0are sent whenever an app is moved to the background."),(0,r.kt)("p",null,"Events are not sent on app close since the OS cannot guarantee advance notice of app closing."),(0,r.kt)("h5",{id:"screen-view-tracking"},"Screen view tracking"),(0,r.kt)("p",null,"Auto-tracking can be enabled to send screen view events whenever a screen is changed in the app (a screen change corresponds to when\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"viewDidAppear()"),"\xa0is called on a view controller)."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPTracker *tracker = [SPTracker build:^(id<SPTrackerBuilder> builder) {\n    [builder setEmitter:emitter];\n    [builder setScreenViewEvents:YES];\n}];\n")),(0,r.kt)("h5",{id:"exception-tracking"},"Exception tracking"),(0,r.kt)("p",null,"Auto-tracking can be enabled to send an event for exceptions that are raised. The only caveat is that the exception event will be sent when the tracker is restarted."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPTracker *tracker = [SPTracker build:^(id<SPTrackerBuilder> builder) {\n    [builder setEmitter:emitter];\n    [builder setExceptionEvents:YES];\n}];\n")),(0,r.kt)("h5",{id:"install-tracking"},"Install tracking"),(0,r.kt)("p",null,"Auto-tracking can be enabled to send an install event whenever the tracker is used for the first time in an app. The tracker will record when it\u2019s first been installed, so deleting and reinstalling an app will trigger another install event."),(0,r.kt)("p",null,"If install auto-tracking is not enabled, the tracker will still keep track of when the app was first installed, so that when enabled, the tracker will send the recorded install event with a timestamp reflecting when it was first installed."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPTracker *tracker = [SPTracker build:^(id<SPTrackerBuilder> builder) {\n    [builder setEmitter:emitter];\n    [builder setInstallEvents:YES];\n}];\n")),(0,r.kt)("h4",{id:"standard-contexts"},"Standard contexts"),(0,r.kt)("p",null,"These are out-of-the-box tracker options that when enabled will attach useful contexts to every event."),(0,r.kt)("h5",{id:"session-context"},"Session context"),(0,r.kt)("p",null,"The\xa0",(0,r.kt)("a",{parentName:"p",href:"https://github.com/snowplow/iglu-central/blob/master/schemas/com.snowplowanalytics.snowplow/client_session/jsonschema/1-0-1"},"session context"),"\xa0includes sessionization information like user ID and session ID that can be used to relate user activity patterns to events."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPTracker *tracker = [SPTracker build:^(id<SPTrackerBuilder> builder) {\n    [builder setEmitter:emitter];\n    [builder setSessionContext:YES];\n}];\n")),(0,r.kt)("h5",{id:"application-context"},"Application context"),(0,r.kt)("p",null,"The\xa0",(0,r.kt)("a",{parentName:"p",href:"https://github.com/snowplow/iglu-central/blob/master/schemas/com.snowplowanalytics.mobile/application/jsonschema/1-0-0"},"application context"),"\xa0includes app build and version number."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPTracker *tracker = [SPTracker build:^(id<SPTrackerBuilder> builder) {\n    [builder setEmitter:emitter];\n    [builder setApplicationContext:YES];\n}];\n")),(0,r.kt)("h5",{id:"screen-context"},"Screen Context"),(0,r.kt)("p",null,"The\xa0",(0,r.kt)("a",{parentName:"p",href:"https://github.com/snowplow/iglu-central/blob/master/schemas/com.snowplowanalytics.mobile/screen/jsonschema/1-0-0"},"screen context"),"\xa0contains information related to the current screen being viewed on the device when the event is created."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPTracker *tracker = [SPTracker build:^(id<SPTrackerBuilder> builder) {\n    [builder setEmitter:emitter];\n    [builder setScreenContext:YES];\n}];\n")),(0,r.kt)("h5",{id:"platform-context"},"Platform context"),(0,r.kt)("p",null,"The platform context will either be a\xa0",(0,r.kt)("a",{parentName:"p",href:"https://github.com/snowplow/iglu-central/blob/master/schemas/com.snowplowanalytics.snowplow/mobile_context/jsonschema/1-0-1"},"mobile"),"\xa0or\xa0",(0,r.kt)("a",{parentName:"p",href:"https://github.com/snowplow/iglu-central/blob/master/schemas/com.snowplowanalytics.snowplow/desktop_context/jsonschema/1-0-0"},"desktop"),"\xa0context depending on which platform sends the event. It is enabled by adding an\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"SPSubject"),"\xa0to the tracker."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPTracker *tracker = [SPTracker build:^(id<SPTrackerBuilder> builder) {\n    [builder setEmitter:emitter];\n    [builder setPlatformContext:YES];\n}];\n\nSPSubject *subject = [[SPSubject alloc] initWithPlatformContext:YES andGeoContext:NO];\n\n[tracker setSubject:subject];\n")),(0,r.kt)("h5",{id:"geolocation-context"},"Geolocation context"),(0,r.kt)("p",null,"The\xa0",(0,r.kt)("a",{parentName:"p",href:"https://github.com/snowplow/iglu-central/blob/master/schemas/com.snowplowanalytics.snowplow/geolocation_context/jsonschema/1-1-0"},"geolocation context"),"\xa0is enabled by adding an\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"SPSubject"),"\xa0to the tracker."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPTracker *tracker = [SPTracker build:^(id<SPTrackerBuilder> builder) {\n    [builder setEmitter:emitter];\n    [builder setPlatformContext:YES];\n}];\n\nSPSubject *subject = [[SPSubject alloc] initWithPlatformContext:NO andGeoContext:YES];\n\n[tracker setSubject:subject];\n")),(0,r.kt)("h3",{id:"emitter-options"},"Emitter options"),(0,r.kt)("p",null,"These options are used to fine-tune the emitter."),(0,r.kt)("h4",{id:"setting-the-request-method"},"Setting the request method"),(0,r.kt)("p",null,"The request method used to connect to the collector, either:\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"SPRequestGet"),", or\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"SPRequestPost"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPEmitter *emitter = [SPEmitter build:^(id<SPEmitterBuilder> builder) {\n    [builder setUrlEndpoint:_url];\n    [builder setHttpMethod:SPRequestPost];\n}];\n")),(0,r.kt)("p",null,"In a GET request, each event is sent in an individual request. In a POST request, events can be bundled together in one request."),(0,r.kt)("h4",{id:"setting-the-protocol"},"Setting the protocol"),(0,r.kt)("p",null,"The protocol used to connect to the collector, either:\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"SPHttp"),", or\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"SPHttps"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPEmitter *emitter = [SPEmitter build:^(id<SPEmitterBuilder> builder) {\n    [builder setUrlEndpoint:_url];\n    [builder setProtocol:SPHttps];\n}];\n")),(0,r.kt)("h4",{id:"setting-a-callback"},"Setting a callback"),(0,r.kt)("p",null,"An emitter callback can be set which will be called with the count of successful and failed events."),(0,r.kt)("p",null,"To implement you will need to:"),(0,r.kt)("p",null,"Add the RequestCallback protocol to your header file:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"// Example from the SnowplowDemo -> ViewController.h file:\n@interface ViewController : UIViewController <UITextFieldDelegate, RequestCallback>\n\n// Extra Example\n@interface MyObjcClass : NSObject <RequestCallback>\n")),(0,r.kt)("p",null,"In your paired .m file add the following functions:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"// Define Callback Functions\n- (void) onSuccessWithCount:(NSInteger)successCount {\n    // Do something with result\n}\n\n- (void) onFailureWithCount:(NSInteger)failureCount successCount:(NSInteger)successCount {\n    // Do something with results\n}\n")),(0,r.kt)("p",null,"Construct the SPEmitter like so:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},'NSURL *url = [[NSURL alloc] initWithString:@"https://collector.acme.net"];\n\nSPEmitter *emitter = [SPEmitter build:^(id<SPEmitterBuilder> builder) {\n    [builder setUrlEndpoint:url];\n    [builder setCallback:self];\n}];\n')),(0,r.kt)("p",null,"The self will work only if you have declared the callback functions in the same class as you are creating the emitter. Otherwise you will need to pass in the target for the class in which you have defined these functions."),(0,r.kt)("h4",{id:"range"},"Range"),(0,r.kt)("p",null,"The number of events retrieved from storage in the database whenever the emitter needs more to send."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},'NSURL *url = [[NSURL alloc] initWithString:@"https://collector.acme.net"];\n\nSPEmitter *emitter = [SPEmitter build:^(id<SPEmitterBuilder> builder) {\n    [builder setUrlEndpoint:url];\n    [builder setEmitRange:200];\n}];\n')),(0,r.kt)("h4",{id:"thread-pool-size"},"Thread pool size"),(0,r.kt)("p",null,"This is the number of threads created to make requests for sending events:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},'NSURL *url = [[NSURL alloc] initWithString:@"https://collector.acme.net"];\n\nSPEmitter *emitter = [SPEmitter build:^(id<SPEmitterBuilder> builder) {\n    [builder setUrlEndpoint:url];\n    [builder setEmitThreadPoolSize:15];\n}];\n')),(0,r.kt)("h4",{id:"get-byte-limit"},"GET byte limit"),(0,r.kt)("p",null,"The maximum data size of GET requests made by the emitter to send events."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPEmitter *emitter = [SPEmitter build:^(id<SPEmitterBuilder> builder) {\n    [builder setUrlEndpoint:_url]; // Required\n    [builder setByteLimitGet:50000]; // Optional\n}];\n")),(0,r.kt)("h4",{id:"post-byte-limit"},"POST byte limit"),(0,r.kt)("p",null,"The maximum data size of POST requests made by the emitter to send events."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPEmitter *emitter = [SPEmitter build:^(id<SPEmitterBuilder> builder) {\n    [builder setUrlEndpoint:_url]; // Required\n    [builder setByteLimitPost:50000]; // Optional\n}];\n")),(0,r.kt)("h3",{id:"global-contexts"},"Global contexts"),(0,r.kt)("p",null,"Contexts add extra data to events, such as event circumstances like geo-location, device, or application information. Contexts can be attached in each tracking method:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},'event = [SPStructured build:^(id<SPStructuredBuilder> builder) {\n  [builder setCategory:@"DemoCategory"];\n  [builder setAction:@"DemoAction"];\n  [builder setContexts:[NSMutableArray arrayWithArray:@[poster]]];\n}];\n[tracker trackStructuredEvent:event];\n')),(0,r.kt)("p",null,"There\u2019s also the option to specify standard contexts that are attached to all events:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},"SPTracker *tracker = [SPTracker build:^(id<SPTrackerBuilder> builder) {\n    [builder setEmitter:emitter];\n    [builder setScreenContext:YES];\n}];\n")),(0,r.kt)("p",null,"While these are useful for some implementations - there may be times when we\u2019d like a custom context to be added to all events automatically. Or perhaps we\u2019d like to send a context with every event that\u2019s generated dynamically based on external information or through inspecting the event that it\u2019s attached to."),(0,r.kt)("p",null,"Global contexts are meant to be used for these situations. They expand contexts to include conditional or dynamic behavior."),(0,r.kt)("h4",{id:"context-primitives"},"Context primitives"),(0,r.kt)("p",null,"Context primitive is a term for anything that can be used as a context. A context primitive is either a self-describing JSON, or a callback that creates a self-describing JSON (in Obj-C callbacks are implemented as\xa0",(0,r.kt)("a",{parentName:"p",href:"https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/WorkingwithBlocks/WorkingwithBlocks.html"},"blocks"),")."),(0,r.kt)("h5",{id:"self-describing-json"},"Self-describing JSON"),(0,r.kt)("p",null,"A self-describing JSON is used as a global context when you\u2019d like define a context that is attached to every event and never changes."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"SPSelfDescribingJson"),"\xa0takes two arguments, some data and its associated schema URI:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-objectivec"},'SPSelfDescribingJson * context = [[SPSelfDescribingJson alloc] initWithSchema:@"iglu:com.acme/event/jsonschema/1-0-0"\n                                                                      andData:@{\n                                                                                 @"someData": @42\n                                                                                }];\n')),(0,r.kt)("h3",{id:"idfa-tracking"},"IDFA tracking"),(0,r.kt)("p",null,"IDFA allows advertisers to track a user\u2019s device among reinstalls and apps. Obviously Apple has introduced way to limit the trackability in order to keep high level of privacy for the user. Users can choose to limit ad-tracking by preventing the IDFA being passed to advertisers."),(0,r.kt)("p",null,"The tracker allow to get the IDFA sending it as part of the\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"mobile_context"),"\xa0JSON which is attached to each mobile event."),(0,r.kt)("p",null,"If you want to track the IDFA you need:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Add\xa0",(0,r.kt)("inlineCode",{parentName:"li"},"AdSupport"),"\xa0framework to your app. If it\u2019s not added the tracker will not send the IDFA with the events."),(0,r.kt)("li",{parentName:"ul"},"If you add the\xa0",(0,r.kt)("inlineCode",{parentName:"li"},"AdSupport"),"\xa0framework, please, be aware of the correct way to submit the app to the App Store. If you make use of IDFA you have to declare it during the App submission (More details\xa0",(0,r.kt)("a",{parentName:"li",href:"https://help.apple.com/app-store-connect/#/dev301cb2b3e"},"here"),")."),(0,r.kt)("li",{parentName:"ul"},"The simulators can\u2019t generate a proper IDFA, instead they generate a sequence of zeros. If you want to test IDFA with a real code, please, use the physical device.")),(0,r.kt)("p",null,"If you add the\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"AdSupport"),"\xa0framework but you don\u2019t want get the IDFA with the events:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Disable the IDFA tracking with a preprocessor flag:",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"Go to\xa0",(0,r.kt)("em",{parentName:"li"},"Build Settings"),"\xa0of the imported Snowplow Obj-C Tracker"),(0,r.kt)("li",{parentName:"ol"},"Search for Preprocessor Macros"),(0,r.kt)("li",{parentName:"ol"},"Add a macro defined as\xa0",(0,r.kt)("inlineCode",{parentName:"li"},"SNOWPLOW_NO_IFA=1"))),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Remember: it must be added in the Build Settings of the SnowplowTracker framework. If you set it in the app\u2019s Build Settings it won\u2019t work.")))),(0,r.kt)("p",null,"The user has the ability to limit ad-tracking from the device\u2019s Settings. If the user enable the limitations the tracker will not be able to track the IDFA."),(0,r.kt)("h2",{id:"api-reference"},"API Reference"),(0,r.kt)("p",null,"For documentation detailing the entire Objective-C tracking SDK, please refer to the API reference found\xa0",(0,r.kt)("a",{parentName:"p",href:"https://snowplow.github.io/snowplow-objc-tracker/"},"here"),"."))}d.isMDXComponent=!0}}]);