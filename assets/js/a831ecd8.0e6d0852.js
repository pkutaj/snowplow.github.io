"use strict";(self.webpackChunkdocsite_poc_github_io=self.webpackChunkdocsite_poc_github_io||[]).push([[9160],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var d=a.createContext({}),s=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(d.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,d=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=s(n),h=o,m=p["".concat(d,".").concat(h)]||p[h]||c[h]||r;return n?a.createElement(m,i(i({ref:t},u),{},{components:n})):a.createElement(m,i({ref:t},u))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=p;var l={};for(var d in t)hasOwnProperty.call(t,d)&&(l[d]=t[d]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var s=2;s<r;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},35171:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>s});var a=n(87462),o=(n(67294),n(3905));const r={title:"Tutorial: Understanding bad data",date:"2021-01-05",sidebar_position:80},i=void 0,l={unversionedId:"try-snowplow/recipes/recipe-understanding-bad-data/index",id:"try-snowplow/recipes/recipe-understanding-bad-data/index",title:"Tutorial: Understanding bad data",description:"Introduction",source:"@site/docs/try-snowplow/recipes/recipe-understanding-bad-data/index.md",sourceDirName:"try-snowplow/recipes/recipe-understanding-bad-data",slug:"/try-snowplow/recipes/recipe-understanding-bad-data/",permalink:"/docs/try-snowplow/recipes/recipe-understanding-bad-data/",draft:!1,editUrl:"https://github.com/snowplow/snowplow.github.io/tree/main/docs/try-snowplow/recipes/recipe-understanding-bad-data/index.md",tags:[],version:"current",lastUpdatedAt:1661352356,formattedLastUpdatedAt:"Aug 24, 2022",sidebarPosition:80,frontMatter:{title:"Tutorial: Understanding bad data",date:"2021-01-05",sidebar_position:80},sidebar:"tutorialSidebar",previous:{title:"Tutorial: User engagement",permalink:"/docs/try-snowplow/recipes/recipe-user-engagement/"},next:{title:"Troubleshooting",permalink:"/docs/try-snowplow/try-snowplow-faq/"}},d={},s=[{value:"Introduction",id:"introduction",level:2},{value:"What you&#39;ll be doing",id:"what-youll-be-doing",level:2},{value:"Checking if you have bad data",id:"checking-if-you-have-bad-data",level:4},{value:"Generating bad data (optional)",id:"generating-bad-data-optional",level:4},{value:"Understanding your bad data",id:"understanding-your-bad-data",level:4},{value:"Learn more about how Snowplow processes data",id:"learn-more-about-how-snowplow-processes-data",level:2}],u={toc:s};function c(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"introduction"},"Introduction"),(0,o.kt)("p",null,'Snowplow has the concept of upfront data validation: you get to decide what your data should look like, and data that does not match your definitions is classified as "bad data". Detailed information on the different failure types can be found in ',(0,o.kt)("a",{parentName:"p",href:"/docs/managing-data-quality/failed-events/understanding-failed-events/"},"the technical documentation"),"."),(0,o.kt)("p",null,"This bad data is not simply dropped, but rather loaded into dedicated locations so you can understand what went wrong and how your tracking implementation or your data structure definitions need to be updated to resolve the issue. This approach ensures you don't need to waste time cleaning data but can instead rely on Snowplow delivering only the highest quality data to you."),(0,o.kt)("p",null,"Snowplow BDP comes with a dedicated failed events monitoring tool, you can take a look at it in ",(0,o.kt)("a",{parentName:"p",href:"/docs/managing-data-quality/failed-events/failed-events-in-the-ui/"},"the documentation"),". With Try Snowplow, failed events are loaded into a ",(0,o.kt)("inlineCode",{parentName:"p"},"badrows")," schema for monitoring and analysing. This recipe will teach you how to access and understand any bad Snowplow data you might have collected."),(0,o.kt)("h2",{id:"what-youll-be-doing"},"What you'll be doing"),(0,o.kt)("h4",{id:"checking-if-you-have-bad-data"},"Checking if you have bad data"),(0,o.kt)("p",null,"You can see the different bad data tables by running the following query:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"SELECT * FROM information_schema.tables\nWHERE table_schema = 'badrows';\n")),(0,o.kt)("p",null,"Please note that not all bad data is actually a source of concern. For example, if you navigate directly to your collector endpoint, you will generate a bad request. Therefore, certain types of bad events can be ignored. For more detail on the different failure types, check out ",(0,o.kt)("a",{parentName:"p",href:"/docs/managing-data-quality/failed-events/understanding-failed-events/"},"the technical documentation"),"."),(0,o.kt)("p",null,"In this recipe, you will focus on schema violations, i.e. errors that occur because data is not tracked as expected. To check if you already have any existing schema violations, you can run the following query:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"SELECT COUNT(*) AS bad_events FROM badrows.com_snowplowanalytics_snowplow_badrows_schema_violations_2;\n")),(0,o.kt)("p",null,"Please note that an issue with an entity attached to an event will cause the entire event to fail. More information on Snowplow's events and entities can be found ",(0,o.kt)("a",{parentName:"p",href:"/docs/understanding-tracking-design/understanding-events-entities/"},"here"),"."),(0,o.kt)("h4",{id:"generating-bad-data-optional"},"Generating bad data (optional)"),(0,o.kt)("p",null,"If you do not have any bad data yet, you can send some on purpose to see what it looks like. For example, you could send an event with a schema that does not exist:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'window.snowplow(\'trackSelfDescribingEvent\', {\n   "event": {\n      "schema": "iglu:com.trysnowplow/example_event/jsonschema/1-0-0",\n      "data": {\n         "example_field": "This is a bad data test!"\n      }\n   }\n });\n')),(0,o.kt)("p",null,"Alternatively, if you have already implemented one of the recipes that involve implementing a custom event or entity, you could try updating the tracking code to purposefully cause bad data. For example, if you have instrumented the ",(0,o.kt)("a",{parentName:"p",href:"/docs/try-snowplow/recipes/recipe-marketing-attribution/"},"marketing attribution recipe"),", you could change the conversion event, either by sending an incorrect type for one property:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'window.snowplow(\'trackSelfDescribingEvent\', {\n   "event": {\n      "schema": "iglu:com.trysnowplow/conversion/jsonschema/1-0-0",\n      "data": {\n         "name": "email-signup",\n         "value": "10" // this is meant to be an integer\n      }\n   }\n });\n')),(0,o.kt)("p",null,"Or by making a property larger than allowed:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'window.snowplow(\'trackSelfDescribingEvent\', {\n   "event": {\n      "schema": "iglu:com.trysnowplow/conversion/jsonschema/1-0-0",\n      "data": {\n         "name": "This property is only meant to be 255 characters long. When you send a value that is longer, the event will fail validation and end up as a bad event. In this case that is on purpose, as an exercise to understand Snowplow\'s concept of bad data. In real life, bad data typically means you need to either update your data structure definitions or your tracking code to resolve the issue."\n     }\n   }\n });\n')),(0,o.kt)("p",null,"The custom event in this example does not have any required properties, but if the event you have already instrumented does, you can also try omitting those."),(0,o.kt)("h4",{id:"understanding-your-bad-data"},"Understanding your bad data"),(0,o.kt)("p",null,"Once you have confirmed you have bad data, you want to understand what it means and where it comes from. The following query shows you how many bad events you have by schema (data structure) and error type:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"SELECT\n   \"failure.messages\"->0->'error'->'error' AS error,\n   \"failure.messages\"->0->'schemaKey' AS schema,\n   count(*) AS bad_events\n FROM badrows.com_snowplowanalytics_snowplow_badrows_schema_violations_2\n GROUP BY 1,2\n ORDER BY 3 DESC\n")),(0,o.kt)("p",null,"Common error types include:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Resolution errors: the schema cannot be found"),(0,o.kt)("li",{parentName:"ul"},"Validation errors: a property in the event or entity does not match its definition in the schema, or is not defined in the schema at all")),(0,o.kt)("p",null,"Other useful fields in this table are:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},'"payload.enriched.collector_tstamp"'),": the time at which the event was collected"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},'"payload.enriched.unstruct_event"'),": the custom event payload"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},'"payload.enriched.contexts"'),": the entities payload"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},'"payload.raw.parameters"'),": the entire request payload")),(0,o.kt)("p",null,"This information allows you to understand where these bad events are being generated, and therefore to resolve the issue and ensure that you are collecting high quality data you can trust."),(0,o.kt)("h2",{id:"learn-more-about-how-snowplow-processes-data"},"Learn more about how Snowplow processes data"),(0,o.kt)("p",null,"This recipe has focused on understanding bad data resulting from tracking issues. However, as part of pipeline processing events aren't just validated, they are also enriched. Enrichment allows you to add more information to each event in real time, based on first and third party sources. But the enrichment process can also lead to failed events, for example when an API that is being called is not available."),(0,o.kt)("p",null,"Try Snowplow comes with a set of standard enrichments enabled out of the box:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Campaign attribution"),(0,o.kt)("li",{parentName:"ul"},"Referer parser"),(0,o.kt)("li",{parentName:"ul"},"UA parser"),(0,o.kt)("li",{parentName:"ul"},"PII Pseudonymization")),(0,o.kt)("p",null,"To see the full list of enrichments available with Snowplow BDP, including the customizable enrichments, check out ",(0,o.kt)("a",{parentName:"p",href:"/docs/enriching-your-data/available-enrichments/"},"the documentation"),"."))}c.isMDXComponent=!0}}]);