<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-migrated/pipeline-components-and-applications/loaders-storage-targets/elasticsearch-loader/index">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<title data-rh="true">Elasticsearch Loader | Snowplow Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://andy-hay.github.io/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets/elasticsearch-loader"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Elasticsearch Loader | Snowplow Docs"><meta data-rh="true" name="description" content="If you are using Stream Enrich to write enriched Snowplow events to one stream and bad events to another, you can use the Elasticsearch Loader to read events from either of those streams and write them to Elasticsearch. It works with either Kinesis or NSQ streams."><meta data-rh="true" property="og:description" content="If you are using Stream Enrich to write enriched Snowplow events to one stream and bad events to another, you can use the Elasticsearch Loader to read events from either of those streams and write them to Elasticsearch. It works with either Kinesis or NSQ streams."><link data-rh="true" rel="icon" href="/docsite-poc.github.io/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://andy-hay.github.io/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets/elasticsearch-loader"><link data-rh="true" rel="alternate" href="https://andy-hay.github.io/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets/elasticsearch-loader" hreflang="en"><link data-rh="true" rel="alternate" href="https://andy-hay.github.io/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets/elasticsearch-loader" hreflang="x-default"><link rel="stylesheet" href="/docsite-poc.github.io/assets/css/styles.96d61308.css">
<link rel="preload" href="/docsite-poc.github.io/assets/js/runtime~main.70369f61.js" as="script">
<link rel="preload" href="/docsite-poc.github.io/assets/js/main.a8678f5c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docsite-poc.github.io/"><div class="navbar__logo"><img src="/docsite-poc.github.io/img/snowplow-icon-light-purple.svg" alt="SnowPlow Docs Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docsite-poc.github.io/img/snowplow-icon-light-purple.svg" alt="SnowPlow Docs Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Snowplow Docs</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docsite-poc.github.io/docs/migrated">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Andy-Hay/docsite-poc.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docsite-poc.github.io/docs/migrated">Snowplow Documentation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Snowplow Documentation&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/getting-started-with-snowplow-bdp">Getting started on Snowplow BDP</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting started on Snowplow BDP&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/getting-started-on-snowplow-open-source">Getting started on Snowplow Open Source</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting started on Snowplow Open Source&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/try-snowplow">Try Snowplow</a><button aria-label="Toggle the collapsible sidebar category &#x27;Try Snowplow&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/open-source-quick-start">Snowplow Open Source Quick Start</a><button aria-label="Toggle the collapsible sidebar category &#x27;Snowplow Open Source Quick Start&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/understanding-your-pipeline">Understanding your pipeline</a><button aria-label="Toggle the collapsible sidebar category &#x27;Understanding your pipeline&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/understanding-tracking-design">Designing tracking</a><button aria-label="Toggle the collapsible sidebar category &#x27;Designing tracking&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/collecting-data">Collecting data with Trackers and Webhooks</a><button aria-label="Toggle the collapsible sidebar category &#x27;Collecting data with Trackers and Webhooks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/enriching-your-data">Enriching your data</a><button aria-label="Toggle the collapsible sidebar category &#x27;Enriching your data&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/modeling-your-data">Modeling your data</a><button aria-label="Toggle the collapsible sidebar category &#x27;Modeling your data&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/forwarding-events-to-destinations">Forwarding events to Destinations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Forwarding events to Destinations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/managing-data-quality">Managing data quality</a><button aria-label="Toggle the collapsible sidebar category &#x27;Managing data quality&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/using-the-snowplow-console">Snowplow Console</a><button aria-label="Toggle the collapsible sidebar category &#x27;Snowplow Console&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications">Pipeline Components and Applications</a><button aria-label="Toggle the collapsible sidebar category &#x27;Pipeline Components and Applications&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/version-compatibility-matrix">Version compatibility matrix</a><button aria-label="Toggle the collapsible sidebar category &#x27;Version compatibility matrix&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/stream-collector">Stream Collector</a><button aria-label="Toggle the collapsible sidebar category &#x27;Stream Collector&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/sqs2kinesis">Sqs2kinesis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Sqs2kinesis&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/enrichment-components">Enrichment</a><button aria-label="Toggle the collapsible sidebar category &#x27;Enrichment&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets">Loaders and storage targets</a><button aria-label="Toggle the collapsible sidebar category &#x27;Loaders and storage targets&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets/s3-loader">S3 Loader</a><button aria-label="Toggle the collapsible sidebar category &#x27;S3 Loader&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets/snowplow-rdb-loader-3-0-0">RDB Loader</a><button aria-label="Toggle the collapsible sidebar category &#x27;RDB Loader&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets/snowplow-snowflake-loader">Snowflake Loader</a><button aria-label="Toggle the collapsible sidebar category &#x27;Snowflake Loader&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader">BigQuery Loader</a><button aria-label="Toggle the collapsible sidebar category &#x27;BigQuery Loader&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets/google-cloud-storage-loader">Google Cloud Storage Loader</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets/elasticsearch-loader">Elasticsearch Loader</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets/snowplow-postgres-loader">Postgres Loader</a><button aria-label="Toggle the collapsible sidebar category &#x27;Postgres Loader&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets/events-manifest-populator">Events Manifest Populator</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets/emr-etl-runner">EmrEtlRunner</a><button aria-label="Toggle the collapsible sidebar category &#x27;EmrEtlRunner&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/iglu">Iglu</a><button aria-label="Toggle the collapsible sidebar category &#x27;Iglu&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/dataflow-runner">Dataflow Runner</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/snowplow-mini">Snowplow Mini</a><button aria-label="Toggle the collapsible sidebar category &#x27;Snowplow Mini&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/piinguin">Piinguin</a><button aria-label="Toggle the collapsible sidebar category &#x27;Piinguin&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/right-to-be-forgotten-spark-application">Right to be Forgotten Spark Application</a><button aria-label="Toggle the collapsible sidebar category &#x27;Right to be Forgotten Spark Application&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/contributing">Community &amp; contributing</a><button aria-label="Toggle the collapsible sidebar category &#x27;Community &amp; contributing&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docsite-poc.github.io/docs/migrated/tutorials">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docsite-poc.github.io/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docsite-poc.github.io/docs/migrated"><span itemprop="name">Snowplow Documentation</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications"><span itemprop="name">Pipeline Components and Applications</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets"><span itemprop="name">Loaders and storage targets</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Elasticsearch Loader</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Elasticsearch Loader</h1></header><p>If you are using <a href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/enrichment-components/stream-enrich">Stream Enrich</a> to write enriched Snowplow events to one stream and bad events to another, you can use the Elasticsearch Loader to read events from either of those streams and write them to <a href="http://www.elasticsearch.org/overview/" target="_blank" rel="noopener noreferrer">Elasticsearch</a>. It works with either Kinesis or NSQ streams.</p><p>When loading enriched events, the resulting JSONs are like the <a href="/docsite-poc.github.io/docs/migrated/understanding-your-pipeline/canonical-event">Snowplow Canonical Event model</a> with the following changes:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="boolean-fields-reformatted"><a href="https://github.com/snowplow/snowplow/wiki/Elasticsearch-Loader#boolean-fields-reformatted" target="_blank" rel="noopener noreferrer"></a>Boolean fields reformatted<a class="hash-link" href="#boolean-fields-reformatted" title="Direct link to heading">​</a></h3><p>All boolean fields like <code>br_features_java</code> are either <code>&quot;0&quot;</code> or <code>&quot;1&quot;</code> in the canonical event model. The JSON converts these values to <code>false</code> and <code>true</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="newgeo_locationfield"><a href="https://github.com/snowplow/snowplow/wiki/Elasticsearch-Loader#new-geo_location-field" target="_blank" rel="noopener noreferrer"></a>New <code>geo_location</code> field<a class="hash-link" href="#newgeo_locationfield" title="Direct link to heading">​</a></h3><p>The <code>geo_latitude</code> and <code>geo_longitude</code> fields are combined into a single <code>geo_location</code> field of Elasticsearch&#x27;s <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/geo-point.html" target="_blank" rel="noopener noreferrer">&quot;geo<!-- -->_<!-- -->point&quot; type</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="unstructured-events"><a href="https://github.com/snowplow/snowplow/wiki/Elasticsearch-Loader#unstructured-events" target="_blank" rel="noopener noreferrer"></a>Unstructured events<a class="hash-link" href="#unstructured-events" title="Direct link to heading">​</a></h3><p>Unstructured events are expanded into full JSONs. For example, the event</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;schema&quot;: &quot;iglu:com.snowplowanalytics.snowplow/link_click/jsonschema/1-0-1&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;data&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;targetUrl&quot;: &quot;http://snowplowanalytics.com/analytics/index.html&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;elementId&quot;: &quot;action&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;elementClasses&quot;: [],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;elementTarget&quot;: &quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>would be converted to the field</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;unstruct_com_snowplowanalytics_snowplow_link_click_1&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;targetUrl&quot;: &quot;http://snowplowanalytics.com/analytics/index.html&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;elementId&quot;: &quot;action&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;elementClasses&quot;: [],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;elementTarget&quot;: &quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="custom-contexts"><a href="https://github.com/snowplow/snowplow/wiki/Elasticsearch-Loader#custom-contexts" target="_blank" rel="noopener noreferrer"></a>Custom contexts<a class="hash-link" href="#custom-contexts" title="Direct link to heading">​</a></h3><p>Each custom context in an array is similarly expanded to a JSON with its own field. For example, the array</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;schema&quot;: &quot;iglu:com.acme/contextOne/jsonschema/1-0-0&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;data&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;key&quot;: &quot;value&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;schema&quot;: &quot;iglu:com.acme/contextTwo/jsonschema/3-0-0&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;data&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;name&quot;: &quot;second&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>would be converted to</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;contexts_com_acme_context_one_1&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;key&quot;: &quot;value&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;contexts_com_acme_context_two_3&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;name&quot;: &quot;second&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setup-guide">Setup guide<a class="hash-link" href="#setup-guide" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-elasticsearch">Configuring Elasticsearch<a class="hash-link" href="#configuring-elasticsearch" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started"><a href="https://github.com/snowplow/snowplow/wiki/Elasticsearch-Loader-Setup#getting-started" target="_blank" rel="noopener noreferrer"></a>Getting started<a class="hash-link" href="#getting-started" title="Direct link to heading">​</a></h4><p>First off, install and set up Elasticsearch version 7.x or 6.x. For more information check out the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/_installation.html" target="_blank" rel="noopener noreferrer">installation guide</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="raising-the-file-limit"><a href="https://github.com/snowplow/snowplow/wiki/Elasticsearch-Loader-Setup#raising-the-file-limit" target="_blank" rel="noopener noreferrer"></a>Raising the file limit<a class="hash-link" href="#raising-the-file-limit" title="Direct link to heading">​</a></h4><p>Elasticsearch keeps a lot of files open simultaneously so you will need to increase the maximum number of files a user can have open. To do this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo vim /etc/security/limits.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Append the following lines to the file:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{{USERNAME}} soft nofile 32000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{{USERNAME}} hard nofile 32000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Where {{USERNAME}} is the name of the user running Elasticsearch. You will need to logout and restart Elasticsearch before the new file limit takes effect.</p><p>To check that this new limit has taken effect you can run the following command from the terminal:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">curl localhost:9200/_nodes/process?pretty</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If the <code>max_file_descriptors</code> equals 32000 it is running with the new limit.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="defining-the-mapping"><a href="https://github.com/snowplow/snowplow/wiki/Elasticsearch-Loader-Setup#defining-the-mapping" target="_blank" rel="noopener noreferrer"></a>Defining the mapping<a class="hash-link" href="#defining-the-mapping" title="Direct link to heading">​</a></h4><p>Use the following request to create the mapping with Elasticsearch 7.x:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">curl -XPUT &#x27;http://localhost:9200/snowplow&#x27; -d &#x27;{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;settings&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;analysis&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;analyzer&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;default&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &quot;type&quot;: &quot;keyword&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;mappings&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;properties&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;geo_location&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;type&quot;: &quot;geo_point&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/removal-of-types.html" target="_blank" rel="noopener noreferrer">mapping types are removed</a> starting from Elasticsearch 7.0.0. If you use any older version, you might need to include mapping type also.</p><p>This initialization sets the default analyzer to &quot;keyword&quot;. This means that string fields will not be split into separate tokens for the purposes of searching. This saves space and ensures that URL fields are handled correctly.</p><p>If you want to tokenize specific string fields, you can change the &quot;properties&quot; field in the mapping like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">curl -XPUT &#x27;http://localhost:9200/snowplow&#x27; -d &#x27;{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;settings&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;analysis&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;analyzer&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;default&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    &quot;type&quot;: &quot;keyword&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;mappings&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;properties&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;geo_location&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;type&quot;: &quot;geo_point&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;field_to_tokenize&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;type&quot;: &quot;string&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;analyzer&quot;: &quot;english&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="installing-the-elasticsearch-loader"><a href="https://github.com/snowplow/snowplow/wiki/Elasticsearch-Loader-Setup#installing-the-elasticsearch-loader" target="_blank" rel="noopener noreferrer"></a>Installing the Elasticsearch Loader<a class="hash-link" href="#installing-the-elasticsearch-loader" title="Direct link to heading">​</a></h3><p>The Elasticsearch Loader is published on Docker Hub:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker pull snowplow/snowplow-elasticsearch-loader:2.0.6</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The container can be run with the following command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker run \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  -v /path/to/config.hocon:/snowplow/config.hocon \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  snowplow/snowplow-elasticsearch-loader:2.0.6 \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --config /snowplow/config.hocon</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Alternatively you can download and run a <a href="https://github.com/snowplow/snowplow-elasticsearch-loader/releases" target="_blank" rel="noopener noreferrer">jar file from the github release</a>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">java -jar snowplow-elasticsearch-loader-2.0.6.jar --config /path/to/config.hocon</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-elasticsearch-loader"><a href="https://github.com/snowplow/snowplow/wiki/Elasticsearch-Loader-Setup#using-the-elasticsearch-loader" target="_blank" rel="noopener noreferrer"></a>Using the Elasticsearch Loader<a class="hash-link" href="#using-the-elasticsearch-loader" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration"><a href="https://github.com/snowplow/snowplow/wiki/Elasticsearch-Loader-Setup#configuration" target="_blank" rel="noopener noreferrer"></a>Configuration<a class="hash-link" href="#configuration" title="Direct link to heading">​</a></h4><p>The sink is configured using a HOCON file, for which you can find examples <a href="https://github.com/snowplow/snowplow-elasticsearch-loader/tree/master/config" target="_blank" rel="noopener noreferrer">here</a>. These are the fields:</p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>purpose</td><td>Required. &quot;ENRICHED<!-- -->_<!-- -->EVENTS&quot; for a stream of successfully enriched events</td></tr></tbody></table><p>&quot;BAD<!-- -->_<!-- -->ROWS&quot; for a stream of bad events<br>
<!-- -->&quot;JSON&quot; for writing plain json |
| input.type | Required. Configures where input events will be read from.<br>
<!-- -->Can be “kinesis”, “stdin” or “nsq” |
| input.streamName | Required when <code>input.type</code> is kinesis or nsq. Name of the stream to read from. |
| input.initialPosition | Required when <code>input.type</code> is kinesis. Used when <code>input.type</code> is Kinesis. Specifies where to start reading from the stream the first time the app is run. &quot;TRIM<!-- -->_<!-- -->HORIZON&quot; for as far back as possible, &quot;LATEST&quot; for as recent as possibly, &quot;AT<!-- -->_<!-- -->TIMESTAMP&quot; for after specified timestamp. |
| input.initialTimestamp | Used when <code>input.type</code> is kinesis. Required when <code>input.initialTimestamp</code> is &quot;AT<!-- -->_<!-- -->TIMESTAMP&quot;. Specifies the timestamp to start read. |
| input.maxRecords | Used when <code>input.type</code> is kinesis. Optional. Maximum number of records fetched in a single request. Default value 10000. |
| input.region | Used when <code>input.type</code> is kinesis. Optional if it can be resolved with <a href="https://sdk.amazonaws.com/java/api/latest/software/amazon/awssdk/regions/providers/DefaultAwsRegionProviderChain.html" target="_blank" rel="noopener noreferrer">AWS region provider chain</a>. Region where the Kinesis stream is located. |
| input.customEndpoint | Used when <code>input.type</code> is kinesis. Optional. Custom endpoint to override AWS Kinesis endpoints, this can be used to specify local endpoints when using localstack. |
| input.dynamodbCustomEndpoint | Used when <code>input.type</code> is kinesis. Optional. Custom endpoint to override AWS DynamoDB endpoints for Kinesis checkpoints lease table, this can be used to specify local endpoints when using Localstack. |
| input.appName | Used when <code>input.type</code> is kinesis. Optional. Used by a DynamoDB table to maintain stream state. Default value &quot;snowplow-elasticsearch-loader&quot;. |
| input.buffer.byteLimit | Used when <code>input.type</code> is kinesis. Optional. The limit of the buffer in terms of bytes. When this value is exceeded, events will be sent to Elasticsearch. Default value 1000000. |
| input.buffer.recordLimit | Used when <code>input.type</code> is kinesis. Optional. The limit of the buffer in terms of record count. When this value is exceeded, events will be sent to Elasticsearch. Default value 500. |
| input.buffer.timeLimit | Used when <code>input.type</code> is kinesis. Optional. The time limit in milliseconds to wait to send the buffer to Elasticsearch. Default value 500. |
| input.channelName | Required when <code>input.type</code> is nsq. Channel name for NSQ source stream. If more than one application reading from the same NSQ topic at the same time, all of them must have unique channel name to be able to get all the data from the same topic. |
| input.nsqlookupdHost | Required when <code>input.type</code> is nsq. Host name for nsqlookupd |
| input.nsqlookupdPort | Required when <code>input.type</code> is nsq. HTTP port for nsqd. |
| output.good.type | Required. Configure where to write good events. Can be &quot;elasticsearch&quot; or &quot;stdout&quot;. |
| output.good.client.endpoint | Required. The Elasticsearch cluster endpoint. |
| output.good.client.port | Optional. The port the Elasticsearch cluster can be accessed on. Default value 9200. |
| output.good.client.username | Optional. HTTP Basic Auth username. Can be removed if not active. |
| output.good.client.password | Optional. HTTP Basic Auth password. Can be removed if not active. |
| output.good.client.shardDateFormat | Optional. Formatting used for sharding good stream, i.e. <!-- -->_<!-- -->yyyy-MM-dd. Can be removed if not needed. |
| output.good.client.shardDateField | Optional. Timestamp field for sharding good stream. If not specified derived<!-- -->_<!-- -->tstamp is used. |
| output.good.client.maxRetries | Optional. The maximum number of request attempts before giving up. Default value 6. |
| output.good.client.ssl | Optional. Whether to use ssl or not. Default value false. |
| output.good.aws.signing | Optional. Whether to activate AWS signing or not. It should be activated if AWS OpenSearch service is used. Default value false. |
| output.good.aws.region | Optional. Region where the AWS OpenSearch service is located. |
| output.good.cluster.index | Required. The Elasticsearch index name. |
| output.good.cluster.documentType | Optional. The Elasticsearch index type. Index types are deprecated in ES &gt;=7.x Therefore, it shouldn&#x27;t be set with ES &gt;=7.x |
| output.good.chunk.byteLimit | Optional. Bulk request to Elasticsearch will be splitted to chunks according given byte limit. Default value 1000000. |
| output.good.chunk.recordLimit | Optional. Bulk request to Elasticsearch will be splitted to chunks according given record limit. Default value 500. |
| output.bad.type | Required. Configure where to write bad rows. Can be &quot;kinesis&quot;, &quot;nsq&quot;, &quot;stderr&quot; or &quot;none&quot;. |
| output.bad.streamName | Required. Stream name for events which are rejected by Elasticsearch. |
| output.bad.region | Used when <code>output.bad.type</code> is kinesis. Optional if it can be resolved with <a href="https://sdk.amazonaws.com/java/api/latest/software/amazon/awssdk/regions/providers/DefaultAwsRegionProviderChain.html" target="_blank" rel="noopener noreferrer">AWS region provider chain</a>. Region where the bad Kinesis stream is located. |
| output.bad.customEndpoint | Used when <code>output.bad.type</code> is kinesis. Optional. Custom endpoint to override AWS Kinesis endpoints, this can be used to specify local endpoints when using localstack. |
| output.bad.nsqdHost | Required when <code>output.bad.type</code> is nsq. Host name for nsqd. |
| output.bad.nsqdPort | Required when <code>output.bad.type</code> is nsq. HTTP port for nsqd. |
| monitoring.snowplow.collector | Optional. Snowplow collector URI for monitoring. Can be removed together with monitoring section. |
| monitoring.snowplow.appId | Optional. The app id used in decorating the events sent for monitoring. Can be removed together with monitoring section. |
| monitoring.metrics.cloudWatch | Optional. Whether to enable Cloudwatch metrics or not. Default value true. |</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-08-15T12:57:30.000Z">Aug 15, 2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets/google-cloud-storage-loader"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Google Cloud Storage Loader</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docsite-poc.github.io/docs/migrated/pipeline-components-and-applications/loaders-storage-targets/snowplow-postgres-loader"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Postgres Loader</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#boolean-fields-reformatted" class="table-of-contents__link toc-highlight">Boolean fields reformatted</a></li><li><a href="#newgeo_locationfield" class="table-of-contents__link toc-highlight">New <code>geo_location</code> field</a></li><li><a href="#unstructured-events" class="table-of-contents__link toc-highlight">Unstructured events</a></li><li><a href="#custom-contexts" class="table-of-contents__link toc-highlight">Custom contexts</a></li><li><a href="#setup-guide" class="table-of-contents__link toc-highlight">Setup guide</a><ul><li><a href="#configuring-elasticsearch" class="table-of-contents__link toc-highlight">Configuring Elasticsearch</a></li><li><a href="#installing-the-elasticsearch-loader" class="table-of-contents__link toc-highlight">Installing the Elasticsearch Loader</a></li><li><a href="#using-the-elasticsearch-loader" class="table-of-contents__link toc-highlight">Using the Elasticsearch Loader</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/snowplow/snowplow" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub for Open Source Snowplow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discourse.snowplowanalytics.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discourse<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://snowplowanalytics.com/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.meetup.com/topics/snowplow/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Meetups<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://snowplowanalytics.com/events/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Events<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/Andy-Hay/docsite-poc.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub for these docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Snowplow Analytics Ltd. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docsite-poc.github.io/assets/js/runtime~main.70369f61.js"></script>
<script src="/docsite-poc.github.io/assets/js/main.a8678f5c.js"></script>
</body>
</html>