<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-modeling-your-data/the-snowplow-mobile-data-model/sql-runner-mobile-data-model/index">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-159566509-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-M24XMJD"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-M24XMJD",{anonymize_ip:!0})</script><title data-rh="true">sql-runner: Mobile data model | Snowplow Documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.snowplowanalytics.com/docs/modeling-your-data/the-snowplow-mobile-data-model/sql-runner-mobile-data-model"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="sql-runner: Mobile data model | Snowplow Documentation"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.snowplowanalytics.com/docs/modeling-your-data/the-snowplow-mobile-data-model/sql-runner-mobile-data-model"><link data-rh="true" rel="alternate" href="https://docs.snowplowanalytics.com/docs/modeling-your-data/the-snowplow-mobile-data-model/sql-runner-mobile-data-model" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.snowplowanalytics.com/docs/modeling-your-data/the-snowplow-mobile-data-model/sql-runner-mobile-data-model" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.17da4835.css">
<link rel="preload" href="/assets/js/runtime~main.a387fc65.js" as="script">
<link rel="preload" href="/assets/js/main.9bff8dd6.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/snowplow-logo.svg" alt="Snowplow Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/snowplow-logo.svg" alt="Snowplow Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a aria-current="page" class="navbar__item navbar__link nav-link__first navbar__link--active" href="/docs">Docs</a><a href="https://discourse.snowplowanalytics.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discourse<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/snowplow/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://try.snowplowanalytics.com/?utm_content=hero-cta&amp;utm_campaign=snowplow-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link snwpl-nav-button">Try Snowplow</a><a href="https://go.snowplowanalytics.com/l/571483/2021-02-19/3sn5nml" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link snwpl-nav-button">Book a demo</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/getting-started-with-snowplow-bdp">Getting started on Snowplow BDP</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting started on Snowplow BDP&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/getting-started-on-snowplow-open-source">Getting started on Snowplow Open Source</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting started on Snowplow Open Source&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/try-snowplow">Try Snowplow</a><button aria-label="Toggle the collapsible sidebar category &#x27;Try Snowplow&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/open-source-quick-start">Snowplow Open Source Quick Start</a><button aria-label="Toggle the collapsible sidebar category &#x27;Snowplow Open Source Quick Start&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/understanding-your-pipeline">Understanding your pipeline</a><button aria-label="Toggle the collapsible sidebar category &#x27;Understanding your pipeline&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/understanding-tracking-design">Designing tracking</a><button aria-label="Toggle the collapsible sidebar category &#x27;Designing tracking&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/collecting-data">Collecting data with Trackers and Webhooks</a><button aria-label="Toggle the collapsible sidebar category &#x27;Collecting data with Trackers and Webhooks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/enriching-your-data">Enriching your data</a><button aria-label="Toggle the collapsible sidebar category &#x27;Enriching your data&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/modeling-your-data">Modeling your data</a><button aria-label="Toggle the collapsible sidebar category &#x27;Modeling your data&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/modeling-your-data/what-is-data-modeling">What is data modeling?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/modeling-your-data/the-snowplow-web-data-model">The Snowplow web data model</a><button aria-label="Toggle the collapsible sidebar category &#x27;The Snowplow web data model&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/modeling-your-data/the-snowplow-mobile-data-model">The Snowplow mobile data model</a><button aria-label="Toggle the collapsible sidebar category &#x27;The Snowplow mobile data model&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/modeling-your-data/the-snowplow-mobile-data-model/sql-runner-mobile-data-model">sql-runner: Mobile data model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/modeling-your-data/the-snowplow-mobile-data-model/dbt-mobile-data-model">dbt: Mobile data model</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/modeling-your-data/setup-and-run-sql-runner">Setup and run SQL Runner</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/modeling-your-data/configuring-and-running-data-models-via-snowplow-bdp">Configuring and running data models via Snowplow BDP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/modeling-your-data/resolving-data-model-failures-via-snowplow-bdp">Resolving data model failures (via Snowplow BDP)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/modeling-your-data/retrieving-job-execution-data-via-the-api">Retrieving data model execution data via the API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/modeling-your-data/analytics-sdk">Analytics SDKs</a><button aria-label="Toggle the collapsible sidebar category &#x27;Analytics SDKs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/forwarding-events-to-destinations">Forwarding events to Destinations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Forwarding events to Destinations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/managing-data-quality">Managing data quality</a><button aria-label="Toggle the collapsible sidebar category &#x27;Managing data quality&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/using-the-snowplow-console">Snowplow Console</a><button aria-label="Toggle the collapsible sidebar category &#x27;Snowplow Console&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/pipeline-components-and-applications">Pipeline Components and Applications</a><button aria-label="Toggle the collapsible sidebar category &#x27;Pipeline Components and Applications&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/contributing">Community &amp; contributing</a><button aria-label="Toggle the collapsible sidebar category &#x27;Community &amp; contributing&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/tutorials">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/modeling-your-data"><span itemprop="name">Modeling your data</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/modeling-your-data/the-snowplow-mobile-data-model"><span itemprop="name">The Snowplow mobile data model</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">sql-runner: Mobile data model</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>sql-runner: Mobile data model</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a class="hash-link" href="#overview" title="Direct link to heading">​</a></h2><p>The Snowplow mobile data model processes and aggregates data collected by the Snowplow <a href="/docs/collecting-data/collecting-from-own-applications/mobile-trackers/previous-versions/objective-c-tracker">iOS</a> and <a href="/docs/collecting-data/collecting-from-own-applications/mobile-trackers/previous-versions/android-tracker">Android</a> mobile trackers into a set of derived tables - screen views, sessions and users - with each table generated by its respective module.</p><p>In addition to these &#x27;standard&#x27; modules there are optional modules that can be enabled depending on your tracker implementation. Currently there is only one such optional module, Application Errors, which provides application crash reporting. These modules produce their own derived output table, as well as being aggregated and joined into &#x27;standard&#x27; modules such as sessions for high level KPIs. As the tracker&#x27;s functionality continues to expand, so will this library of optional modules.</p><p>Unlike the <a href="/docs/modeling-your-data/the-snowplow-web-data-model">web model</a> the level of aggregation is not linear, as shown in the diagram below. This allows the sessions module to consume events other than just screen views, such as app installs or crashes.</p><p><img loading="lazy" src="https://docs.snowplowanalytics.com/wp-content/uploads/sites/2/2021/04/web_vs_mobile.jpg?w=1024" alt="Web vs Mobile" class="img_ev3q"></p><p>The model runs incrementally, only processing new events (and events that have previously been modeled but are part of screen views, sessions or users for which/whom there is new information) with every run. The incremental logic is separate from the logic that calculates the tables so as to make customization of the model easier. More information on the model structure and customization options can be found below.</p><p><strong>The Snowplow mobile data model v1.0.0 can be found in the <a href="https://github.com/snowplow/data-models/tree/master" target="_blank" rel="noopener noreferrer">snowplow/data-models GitHub repository</a>.</strong></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="supported-warehouses">Supported Warehouses<a class="hash-link" href="#supported-warehouses" title="Direct link to heading">​</a></h4><ul><li>Redshift</li><li>BigQuery</li><li>Snowflake</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="requirements">Requirements<a class="hash-link" href="#requirements" title="Direct link to heading">​</a></h4><ul><li>Snowplow <a href="/docs/collecting-data/collecting-from-own-applications/mobile-trackers/previous-versions/android-tracker">Android</a> or <a href="/docs/collecting-data/collecting-from-own-applications/mobile-trackers/previous-versions/objective-c-tracker">iOS</a> mobile tracker version 1.1.0 or later implemented.</li><li>Mobile session context enabled.</li><li>Screen view events enabled.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="quick-start">Quick start<a class="hash-link" href="#quick-start" title="Direct link to heading">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">​</a></h4><ul><li><a href="https://github.com/snowplow/sql-runner" target="_blank" rel="noopener noreferrer">SQL-runner</a> is installed.</li><li>Snowplow <a href="/docs/collecting-data/collecting-from-own-applications/mobile-trackers/previous-versions/android-tracker">Android</a> or <a href="/docs/collecting-data/collecting-from-own-applications/mobile-trackers/previous-versions/objective-c-tracker">iOS</a> mobile tracker implemented with mobile events dataset present in a database.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="playbook-configuration">Playbook Configuration<a class="hash-link" href="#playbook-configuration" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="setting-schemas">Setting Schemas<a class="hash-link" href="#setting-schemas" title="Direct link to heading">​</a></h5><p>For all playbooks within <code>mobile/v1/{warehouse}/sql-runner/playbooks/standard</code>, configure the following:</p><ul><li><code>input_schema</code> - Set to the schema containing your Snowplow events data.</li><li><code>scratch_schema</code> - Set to the scratch/staging schema to contain the intermediate tables generated by this model. Create if required.</li><li><code>output_schema</code> - Set to a schema to contain the model&#x27;s final output tables (<code>mobile_screen_views</code>, <code>mobile_sessions</code> etc.)</li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="base-module">Base Module<a class="hash-link" href="#base-module" title="Direct link to heading">​</a></h5><p>Within the base module&#x27;s main playbook, <code>01-base-main.yml.tmpl</code>:</p><ol><li>Set the <code>start_date</code> as desired.</li><li>Enable the following contexts as desired by setting to <code>True</code>:<ul><li>Mobile - Device type, OS etc.</li><li>Geolocation - Device latitude, longitude, bearing etc.</li><li>Application - App version and build.</li><li>Screen - Screen details associated with a mobile event.</li></ul></li><li>Adjust filtering of events if required:<ul><li><code>platform_filters</code>: Default - <code>platform = &#x27;mob&#x27;</code>. Override if required.</li><li><code>app_id</code>: Default - No filter on <code>app_id</code>. Add if required.</li></ul></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># 01-base-main.yml.tmpl</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">:variables:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   :start_date:         2020-01-01 #Set as required</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   #Enable contexts if desired</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   :mobile_context: false </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   :geolocation_context: false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   :application_context: false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   :screen_context: false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   :platform_filters: [] #Override default if required e.g. [&#x27;mob&#x27;,&#x27;tv&#x27;]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   :app_id_filters: [] #Add app_id filter if required e.g [&#x27;my_app&#x27;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The remaining variables are set to the recommended defaults. For more information please see the base module&#x27;s README within the playbooks directory.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="optional-modules">Optional Modules<a class="hash-link" href="#optional-modules" title="Direct link to heading">​</a></h5><p>Optional modules are disabled by default. Please enable where appropriate by setting <code>enabled: true</code> in the main playbook of each module.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-model">Running the model<a class="hash-link" href="#running-the-model" title="Direct link to heading">​</a></h4><p><a href="#tablocally">Locally</a><a href="#tabin-orchestration">In orchestration</a></p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="authentication">Authentication<a class="hash-link" href="#authentication" title="Direct link to heading">​</a></h5><ol><li>Set database password as an environmental variable.<ul><li>Redshift: Set environmental variable, <code>REDSHIFT_PASSWORD</code>, to your database password.</li><li>BigQuery: Set environmental variable, <code>GOOGLE_APPLICATION_CREDENTIALS</code>, to the path of your GBQ json credential file</li><li>Snowflake: Set environmental variable, <code>SNOWFLAKE_PASSWORD</code>, to your database password.</li></ul></li><li>Fill in the relevant template in <code>.scripts/templates</code> with your database details.<ul><li>Redshift &amp; Snowflake: Leave <code>PASSWORD_PLACEHOLDER</code> as is. This placeholder will be replaced at run time with the credentials from env var <code>{WAREHOUSE}_PASSWORD</code>, set in step 1.</li></ul></li></ol><h5 class="anchor anchorWithStickyNavbar_LWe7" id="execution">Execution<a class="hash-link" href="#execution" title="Direct link to heading">​</a></h5><p>For a full run of the model:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bash .scripts/run_config.sh -b ~/pathTo/sql-runner -c mobile/v1/{warehouse}/sql-runner/configs/datamodeling.json -t .scripts/templates/{warehouse}.yml.tmpl;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For more details please see the README within the <code>.scripts</code> directory.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="authentication-1">Authentication<a class="hash-link" href="#authentication-1" title="Direct link to heading">​</a></h5><p>For each playbook within <code>mobile/v1/{warehouse}/sql-runner/playbooks/standard</code> fill in your database connection details. For more details please refer to the <a href="/docs/modeling-your-data/setup-and-run-sql-runner#target-configuration">SQL Runner Docs</a>.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="execution-1">Execution<a class="hash-link" href="#execution-1" title="Direct link to heading">​</a></h5><p>There are many tools available to schedule and run SQL jobs such as the mobile model. While these tools differ in operation the basic principles to running the mobile model should be similar.</p><p>A series of tasks will need to be set to execute SQL Runner against each individual playbook of the model in turn. For example, to run the main playbook of the base module:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bash {sql-runner-path} -playbook sql-runner/playbooks/standard/01-base/01-base-main.yml.tmpl -sqlroot sql-runner/sql</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The correct order of playbook execution and the dependancies between them can be determined from the datamodeling config file within the repo.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="backfilling">Backfilling<a class="hash-link" href="#backfilling" title="Direct link to heading">​</a></h4><p>By default when first running the model, events will be processed in 7 day increments beginning at the <code>start_date</code> set in the base module&#x27;s playbook, <code>01-base-main.yml.tmpl</code>, as described above. To backfill data faster, set the <code>update_cadence_days</code> in the <code>01-base-main.yml.tmpl</code> to required number of days. Once backfilled, it is recommended to set <code>update_cadence_days</code> back to 7 days for performance.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="testing">Testing<a class="hash-link" href="#testing" title="Direct link to heading">​</a></h4><p>The mobile model comes with a suite of data validation checks to ensure the model is running as intended. These checks are performed by <a href="https://greatexpectations.io/" target="_blank" rel="noopener noreferrer">Great Expectations</a>. The tests were used during the model&#x27;s development and are not required to run the mobile model. If desired, they can however be used during the deployment of the mobile model on your own Snowplow dataset to validate the output. For further details please refer to the README in the <code>.scripts</code> directory.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-configurations">Advanced Configurations<a class="hash-link" href="#advanced-configurations" title="Direct link to heading">​</a></h4><p>This quick start guide covers the implementation process for the majority of use cases. Further configurations can be made such as:</p><ul><li>Running specific modules more frequently than others.</li><li>Running specific modules only.</li><li>Adjusting table scan limits.</li></ul><p>For further details please refer to the READMEs within each module&#x27;s playbook directory.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="technical-architecture">Technical architecture<a class="hash-link" href="#technical-architecture" title="Direct link to heading">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-entire-model">The entire model<a class="hash-link" href="#the-entire-model" title="Direct link to heading">​</a></h4><p>This model consists of a series of modules, each is idempotent and can be run on independent schedules, and each produces a table which serves as the input to the next module.</p><p><img loading="lazy" src="https://docs.snowplowanalytics.com/wp-content/uploads/sites/2/2021/04/mobile_full_model_structure.jpg?w=721" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-individual-modules">The individual modules<a class="hash-link" href="#the-individual-modules" title="Direct link to heading">​</a></h4><p>The ‘standard’ modules can be thought of as source code for the core logic of the model, which Snowplow maintains. These modules carry out the incremental logic in such a way as custom modules can be written to plug into the model’s structure, without needing to write a parallel incremental logic. We recommend that all customisations are written in this way, which allows us to safely maintain and roll out updates to the model, without impact on dependent custom SQL. For more information on this, jump to the section on customizing the model below.</p><p>Each module produces a table which acts as the input to the subsequent module (the <code>_staged</code> tables), and updates a production table – with the exception of the base module, which takes atomic data as its input, and does not update a production table.</p><p>Each module comes with a <code>99-{module}-complete playbook</code>, which marks that module complete by updating any relevant manifests, and truncating the input, and cleaning up temporary tables. The complete steps may be run at the end of each module, or at the end of the run.</p><p>More detail on each module can be found in the relevant READMEs in the <a href="https://github.com/snowplow/data-models/tree/master" target="_blank" rel="noopener noreferrer">GitHub repository</a>.</p><p><img loading="lazy" src="https://docs.snowplowanalytics.com/wp-content/uploads/sites/2/2021/04/web_model_module-1.jpg?w=1024" class="img_ev3q"></p><p>Architecture of an individual mobile module</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="customizing-the-model">Customizing the model<a class="hash-link" href="#customizing-the-model" title="Direct link to heading">​</a></h2><p>Custom modules can fit into the incremental structure by consuming the same inputs, and running before the <code>99-{module}-complete</code> playbook runs. Custom modules may also consume and intermediary tables of the standard module, which will not be dropped until the <code>99-{module}-complete</code> playbook runs.</p><p>Any custom SQL that depends on a <code>_staged</code> table as its input should run before the complete step of the module which handles that same input. For example, custom logic which takes mobile<!-- -->_<!-- -->events<!-- -->_<!-- -->staged as an input should run before the <code>99-sessions-complete</code> playbook which truncates mobile<!-- -->_<!-- -->events<!-- -->_<!-- -->staged.</p><p>An example custom module has been included in <code>mobile/v1/redshift/sql-runner/sql/custom</code>. In this module we:</p><ol><li>Read screen views from <code>scratch.mobile_screen_views_staged</code>.</li><li>Aggregate screen views to one row per <code>session_id</code>.</li><li>Delete and insert into the output table <code>derived.session_goals</code>. This table can then be joined onto <code>derived.mobile_sessions</code> on <code>session_id</code>.</li></ol><p>The playbooks should then be run in the following order:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">standard/01-base/01-base-main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">standard/01-base/99-base-complete</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">standard/02-screen-views/01-screen-views-main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">standard/02-screen-views/99-screen-views-complete</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">standard/03-optional-modules/01-app-errors/01-app-errors-main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">standard/03-optional-modules/01-app-errors/99-app-errors-complete</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">standard/04-sessions/01-sessions-main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">custom/04-session-goals/01-session-goals-main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">custom/04-session-goals/01-session-goals-complete</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">standard/04-sessions/01-sessions-complete</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>An example of this can be seen in the <code>datamodeling_custom_module.json</code> file within the config directory.</p><p>Custom modules can also be created with their own independent manifesting logic, in which case they are more complex, but don’t rely on the standard modules.</p><p>More information on customizing the Snowplow mobile data model can be found in the custom module <a href="https://github.com/snowplow/data-models/blob/master/mobile/v1/redshift/sql-runner/sql/custom/README.md" target="_blank" rel="noopener noreferrer">README</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="metadata">Metadata<a class="hash-link" href="#metadata" title="Direct link to heading">​</a></h2><p>Metadata is logged in the <code>{{.output_schema}}.datamodel_metadata{{.entropy}}</code> table, per-module and per-run. A persistent ID is created, so that separate modules within the same run may be identified.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/snowplow/snowplow.github.io/tree/main/docs/modeling-your-data/the-snowplow-mobile-data-model/sql-runner-mobile-data-model/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-08-24T14:45:56.000Z">Aug 24, 2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/modeling-your-data/the-snowplow-mobile-data-model"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">The Snowplow mobile data model</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/modeling-your-data/the-snowplow-mobile-data-model/dbt-mobile-data-model"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">dbt: Mobile data model</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#quick-start" class="table-of-contents__link toc-highlight">Quick start</a></li><li><a href="#technical-architecture" class="table-of-contents__link toc-highlight">Technical architecture</a></li><li><a href="#customizing-the-model" class="table-of-contents__link toc-highlight">Customizing the model</a></li><li><a href="#metadata" class="table-of-contents__link toc-highlight">Metadata</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Snowplow Analytics Ltd. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a387fc65.js"></script>
<script src="/assets/js/main.9bff8dd6.js"></script>
</body>
</html>